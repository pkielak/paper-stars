<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Paper Stars Background</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Hubballi&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" type="text/css" href="styles.css" />
    </head>
    <body>
        <div class="scroll-container">
            <nav>
                <h1>Paper stars</h1>
            </nav>
            <section id="section1">
                <div class="note">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                    Vivamus blandit dolor eget sollicitudin posuere. Donec metus
                    nunc, ullamcorper sit amet posuere et, ornare id erat. Orci
                    varius natoque penatibus et magnis dis parturient montes,
                    nascetur ridiculus mus.
                </div>
                <div class="note">
                    Praesent ac purus ligula. Pellentesque maximus porttitor
                    mauris, ac imperdiet leo venenatis quis. Nulla suscipit nisi
                    ipsum, in aliquet sem bibendum ut. Mauris sed lorem porta,
                    dignissim eros vitae, convallis massa. Mauris mattis elit ac
                    mi imperdiet, vel sollicitudin leo consequat. Nullam non
                    nisl vitae quam elementum consectetur.
                </div>
            </section>
            <section id="section2">
                <div class="note">
                    Nulla eget pellentesque tellus, accumsan finibus urna.
                    Pellentesque mattis orci sapien, vel vehicula libero gravida
                    et. Nam nisi ex, pulvinar sit amet ultrices et, maximus
                    aliquet mauris. Donec vel augue tempus, gravida est eu,
                    dictum odio. Quisque vel nulla purus. Vestibulum ante ipsum
                    primis in faucibus orci luctus et ultrices posuere cubilia
                    curae;
                </div>
                <div class="note">
                    Donec convallis justo ut lorem porttitor hendrerit in et
                    erat. Suspendisse at enim nec mauris semper volutpat. Etiam
                    vitae justo eu velit euismod euismod. Nullam eu orci auctor,
                    consectetur quam quis, finibus sapien. Ut vitae fringilla
                    leo. Sed at erat cursus, aliquam justo eu, varius mi. Nam
                    vitae quam et magna molestie sagittis id eget nisi.
                </div>
            </section>
            <section id="section3">
                <div class="note">
                    Maecenas cursus nisl lacinia, viverra orci nec, lobortis
                    nisi. Duis in velit eleifend, imperdiet leo ac, varius
                    augue. Etiam sit amet risus nulla. Suspendisse volutpat
                    lectus sit amet nulla viverra, ut lobortis lacus vestibulum.
                    Fusce vestibulum quis risus at convallis. Maecenas ultrices
                    velit vel ipsum rhoncus, eget tempus nisl finibus.
                </div>
                <div class="note">
                    Vivamus egestas, sapien sit amet tempus consequat, ligula
                    ligula tempus dolor, ac hendrerit sem tellus id purus. Nam
                    commodo nisl volutpat ex viverra maximus. Nunc fermentum
                    turpis vitae leo maximus, feugiat porta risus facilisis.
                    Vestibulum eu dolor ut ligula finibus eleifend at eget
                    neque. Donec in turpis consequat, tristique nibh sit amet,
                    fermentum sem.
                </div>
            </section>
        </div>
        <!-- End of scroll-container -->

        <div class="parallax" id="parallax">
            <div class="earth"></div>
            <div class="atmosphere"></div>
            <div class="stars">
                <div
                    class="star-shape"
                    style="
                        left: 50%;
                        top: 50%;
                        transform: translate(-50%, -50%);
                        font-size: 4rem;
                    "
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 20%; top: 30%; font-size: 2.5rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 80%; top: 25%; font-size: 1.8rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 60%; top: 70%; font-size: 3rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 30%; top: 85%; font-size: 2.2rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 90%; top: 60%; font-size: 2.7rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 10%; top: 40%; font-size: 2rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 75%; top: 45%; font-size: 3.2rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 45%; top: 15%; font-size: 2.4rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 55%; top: 90%; font-size: 2.8rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 25%; top: 65%; font-size: 2.1rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 70%; top: 10%; font-size: 2.9rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 5%; top: 50%; font-size: 2.3rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 85%; top: 75%; font-size: 2.6rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 40%; top: 35%; font-size: 3.1rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 95%; top: 5%; font-size: 2.5rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 35%; top: 20%; font-size: 2.7rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 65%; top: 80%; font-size: 3rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 15%; top: 75%; font-size: 2.4rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 80%; top: 90%; font-size: 2.8rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 50%; top: 20%; font-size: 2.9rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 30%; top: 45%; font-size: 2.6rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 70%; top: 55%; font-size: 3.3rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 20%; top: 10%; font-size: 2.2rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 90%; top: 85%; font-size: 2.7rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 40%; top: 60%; font-size: 2.5rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 10%; top: 80%; font-size: 3.1rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 60%; top: 30%; font-size: 2.8rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 50%; top: 40%; font-size: 2.4rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 30%; top: 90%; font-size: 2.6rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 85%; top: 15%; font-size: 2.9rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 75%; top: 60%; font-size: 3.2rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 15%; top: 55%; font-size: 2.3rem"
                >
                    ★
                </div>
                <div
                    class="star-shape"
                    style="left: 45%; top: 75%; font-size: 2.7rem"
                >
                    ★
                </div>
            </div>
        </div>

        <!-- Rocket element -->
        <div class="rocket">
            <!-- Rocket body -->
            <div class="rocket-body">
                <!-- Cockpit -->
                <div class="rocket-window"></div>
                <!-- Fins -->
                <div class="rocket-fin"></div>
                <div class="rocket-fin"></div>
                <div class="rocket-fin"></div>
            </div>

            <!-- Flames -->
            <div class="flames">
                <div class="flame-inner"></div>
                <div class="flame-outer"></div>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const parallax = document.getElementById("parallax");
                const scrollContainer =
                    document.querySelector(".scroll-container");
                const sections = document.querySelectorAll("section");
                let isSnapping = false;
                let snapTimeout;

                // Make sure body and html are proper height
                document.body.style.height = "100vh";
                document.documentElement.style.height = "100vh";

                // Disable CSS animation completely so JavaScript takes over
                parallax.style.animation = "none";

                // Initial position - start with parallax above viewport
                parallax.style.transform = "translateY(-200vh)";
                parallax.style.transition = "none"; // Disable transition initially

                // Function to update parallax position
                function updateStarsPosition() {
                    // Calculate scroll percentage (0 to 1)
                    const scrollPercent =
                        scrollContainer.scrollTop /
                        (scrollContainer.scrollHeight -
                            scrollContainer.clientHeight || 1);

                    // Map to position (-200vh to 0vh)
                    const position = -200 + scrollPercent * 200;

                    // Apply transform
                    parallax.style.transform = `translateY(${position}vh)`;
                }

                // Function to handle scroll snap finishing
                function onSnapFinish() {
                    isSnapping = false;
                    updateStarsPosition(); // Ensure parallax is correctly positioned after snap
                }

                // Enable smooth transitions after initial position is set
                setTimeout(function () {
                    parallax.style.transition = "transform 0.2s ease-out";
                    updateStarsPosition(); // Set initial position based on scroll
                }, 50);

                // Throttle scroll events for better performance
                let ticking = false;
                scrollContainer.addEventListener("scroll", function () {
                    // Clear previous snap timeout if exists
                    if (snapTimeout) {
                        clearTimeout(snapTimeout);
                    }

                    // Set a new timeout for snap finishing
                    snapTimeout = setTimeout(onSnapFinish, 300);

                    if (!ticking && !isSnapping) {
                        window.requestAnimationFrame(function () {
                            updateStarsPosition();
                            ticking = false;
                        });
                        ticking = true;
                    }
                });

                // Update on resize too
                window.addEventListener("resize", updateStarsPosition);

                // Ensure initial scroll is at the top
                scrollContainer.scrollTop = 0;

                // Handle scroll snap events
                scrollContainer.addEventListener("scrollend", function () {
                    isSnapping = false;
                    updateStarsPosition();
                });
            });
        </script>
    </body>
</html>
